<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="CodeDiffuser">
    <meta name="keywords" content="Robotic Manipulation, Language Models, Imitation Learning, RSS, Robotics, Diffusion, Code, Diffusion Policy, Research, Robotics Research, RSS 2025, Foundation Models">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CodeDiffuser: Attention-Enhanced Diffusion Policy via VLM-Generated Code for Instruction Ambiguity</title>

    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NPJWBHQL');</script>
    <!-- End Google Tag Manager -->

    <!-- External Libraries -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">

    <!-- JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
</head>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NPJWBHQL"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
    <div class="navbar-menu">
      <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
        <a class="navbar-item" href="#top">
        <span class="icon">
            <i class="fas fa-home"></i>
        </span>
        </a>
  
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            Outline
          </a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#interactive-visualization">
              Interactive Visualization
            </a>
            <a class="navbar-item" href="#abstract">
              Abstract
            </a>
            <a class="navbar-item" href="#video">
              Video
            </a>
            <a class="navbar-item" href="#method-overview">
              Method Overview
            </a>
            <a class="navbar-item" href="#results">
              Results
            </a>
          </div>
        </div>
      </div>
  
    </div>
</nav>
<section class="hero" id="top">
    <div class="hero-body">
        <div class="container is-fullhd">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-1 publication-title">CodeDiffuser: Attention-Enhanced Diffusion Policy via VLM-Generated Code for Instruction Ambiguity</h1>
                    <div class="is-size-5 publication-authors">
                        <span class="author-block">
                            <a target="_blank" href="https://www.linkedin.com/in/guang-yin-4a0176190/">Guang Yin</a><sup>3, *</sup>,
                        </span>
                        <span class="author-block">
                            <a target="_blank" href="#">Yitong Li</a><sup>4, *</sup>,
                        </span>
                        <span class="author-block">
                            <a target="_blank" href="https://wangyixuan12.github.io/">Yixuan Wang</a><sup>1, *</sup>,
                        </span>
                        <span class="author-block">
                            <a target="_blank" href="https://sites.google.com/umich.edu/dmcconachie">Dale McConachie</a><sup>2</sup>,
                        </span>
                        <span class="author-block">
                            <a target="_blank" href="https://www.paarthshah.me/about">Paarth Shah</a><sup>2</sup>,
                        </span>
                        <br>
                        <span class="author-block">
                            <a target="_blank" href="https://www.linkedin.com/in/kunimatsu-hashimoto-450258a1/">Kunimatsu Hashimoto</a><sup>2</sup>,
                        </span>
                        <span class="author-block">
                            <a target="_blank" href="https://huan-zhang.com/">Huan Zhang</a><sup>3</sup>,
                        </span>
                        <span class="author-block">
                            <a target="_blank" href="https://www.thekatherineliu.com/">Katherine Liu</a><sup>2</sup>,
                        </span>
                        <span class="author-block">
                            <a target="_blank" href="https://yunzhuli.github.io/">Yunzhu Li</a><sup>1</sup>,
                        </span>
                    </div>

                    <div class="is-size-5 publication-authors">
                        <span class="author-block"><sup>1</sup>Columbia University,</span>
                        <span class="author-block"><sup>2</sup>Toyota Research Institute,</span>
                        <span class="author-block"><sup>3</sup>University of Illinois Urbana-Champaign,</span>
                        <span class="author-block"><sup>4</sup>Tsinghua University</span>
                    </div>

                    <div class="column has-text-centered">
                        <div class="publication-links">
                            <!-- PDF Link -->
                            <span class="link-block">
                                <a target="_blank" href="media/pdf/main.pdf"
                                   class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon">
                                        <i class="fas fa-file-pdf"></i>
                                    </span>
                                    <span>Paper</span>
                                </a>
                            </span>

                            <!-- Appendix Link -->
                            <span class="link-block">
                                <a target="_blank" href="media/pdf/supp.pdf"
                                   class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon">
                                        <i class="fas fa-file-pdf"></i>
                                    </span>
                                    <span>Appendix</span>
                                </a>
                            </span>

                            <!-- Arxiv Link -->
                            <!-- <span class="link-block">
                                <a target="_blank" href="https://arxiv.org"
                                   class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon">
                                        <i class="fas fa-file"></i>
                                    </span>
                                    <span>ArXiv [Coming Soon]</span>
                                </a>
                            </span> -->

                            <!-- Video Link -->
                            <span class="link-block">
                                <a target="_blank" href="https://youtu.be/IaDySSp5Wf8"
                                   class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon">
                                        <i class="fab fa-youtube"></i>
                                    </span>
                                    <span>Video</span>
                                </a>
                            </span>

                            <!-- Code Link -->
                            <span class="link-block">
                                <a target="_blank" href="https://github.com/lyttttt3333/CodeDiffuser.git"
                                   class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon">
                                        <i class="fab fa-github"></i>
                                    </span>
                                    <span>Code</span>
                                </a>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="hero teaser">
    <div class="container is-fullhd">
        <div class="hero-body">
            <div class="container">
                <div class="columns is-vcentered is-centered">
                    <video id="teaser" autoplay muted loop height="60%" width="60%">
                        <source src="media/video/teaser.mp4" type="video/mp4">
                    </video>
                <!-- <div class="publication-video">
                    <iframe src="https://www.youtube.com/embed/cC81EqspCok" width="60%" height="60%" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe> -->
                </div>
                <br>
                <br>
                <h2 class="subtitle has-text-centered">
                    <strong>TL;DR:</strong> CodeDiffuser uses VLM-generated code to bridge <strong>high-level language</strong> and <strong>low-level action</strong> to steer low-level visuomotor policy.
                </h2>
            </div>
        </div>
    </div>
</section>

<section class="section" id="interactive-visualization">
    <div class="container">
        <div class="columns is-centered has-text-centered">
            <div class="column is-12">
                <h2 class="title is-3">Interactive Visualization</h2>
            </div>
        </div>
        
        <!-- Task and Configuration Selection -->
        <div class="columns is-centered">
            <div class="column is-8">
                <div class="box">
                    <div class="columns">
                        <div class="column is-6">
                            <label class="label">Task Selection</label>
                            <div class="select is-fullwidth">
                                <select id="task-select" onchange="handleTaskSelect()">
                                    <option value="hang_mug">Hanging Mug</option>
                                    <option value="pack_battery">Packing Battery</option>
                                </select>
                            </div>
                        </div>
                        <div class="column is-6">
                            <label class="label">Initial Configuration</label>
                            <div class="select is-fullwidth">
                                <select id="config-select" onchange="handleConfigSelect()">
                                    <option value="config_1">Configuration 1</option>
                                    <option value="config_2">Configuration 2</option>
                                    <option value="config_3">Configuration 3</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Visualization Area -->
        <div class="columns is-centered">
            <div class="column is-5">
                <div style="text-align: left;">
                    <p style="font-size: 0.875em; color: #666; margin-bottom: 0.5rem;">Select an example or enter custom instruction: (⏳ Waiting time up to one minute.)</p>
                    <div class="field">
                        <div class="control">
                            <div class="select is-small is-fullwidth" style="font-size: 0.875rem;">
                                <select id="instruction-select" onchange="handleInstructionSelect()">
                                    <option value="Hang the blue mug on the left branch">Hang the blue mug on the left branch</option>
                                    <option value="Hang the red mug on the branch furthest to it">Hang the red mug on the branch furthest to it</option>
                                    <option value="Hang the red mug on one branch, sorry, the blue one.">Hang the red mug on one branch, sorry, the blue one.</option>
                                    <option value="I want to use the blue mug. Hang the red mug on one branch.">I want to use the blue mug. Hang the red mug on one branch.</option>
                                    <option value="custom">Custom instruction</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <br>
                <div class="field has-addons" style="position: relative;">
                    <div class="control" style="display: flex; align-items: center;">
                        <img src="media/images/user.png" alt="User" style="width: 32px; height: auto; margin-right: 0.5rem;">
                    </div>
                    <div class="control is-expanded">
                        <input type="text" 
                                id="instruction" 
                                class="input is-small" 
                                style="font-size: 0.875rem;" 
                                placeholder="Hang the blue mug on the left branch."
                                autocomplete="off"
                                spellcheck="false">
                    </div>
                    <div class="control">
                        <button class="button is-primary is-small" 
                                onclick="processInstruction()" 
                                style="font-size: 0.875rem; min-width: 70px;">
                            <span>Enter</span>
                        </button>
                    </div>
                    <div class="control" id="loading" style="display: none; position: absolute; right: -30px; top: 50%; transform: translateY(-50%);">
                        <span class="icon is-small">
                            <i class="fas fa-circle-notch fa-spin"></i>
                        </span>
                    </div>
                </div>
                <div class="columns is-multiline is-centered">
                    <figure class="image" style="width: 100%; height: 400px; display: flex; align-items: center; justify-content: center;">
                        <img id="task-image" src="media/images/hang_mug/config_1.png" style="max-width: 90%; max-height: 90%; object-fit: contain;">
                    </figure>
                </div>
            </div>
            <div class="column is-7" style="margin-top: 0rem;">
                <div class="box">
                    <h3 class="title is-5">3D Attention Map Visualization</h3>
                    <div id="visualization" style="width: 100%; height: 400px; display: flex; align-items: center; justify-content: center;"></div>
                </div>
            </div>
        </div>

        <!-- Intermediate Results -->
        <div class="columns is-centered">
            <div class="column is-12">
                <div class="box">
                    <div class="level">
                        <div class="level-left">
                            <h3 class="title is-5">Intermediate Results</h3>
                        </div>
                        <div class="level-right">
                            <button class="button is-small" onclick="toggleIntermediateResults()" id="toggle-btn">
                                <span class="icon is-small">
                                    <i class="fas fa-chevron-down" id="toggle-icon"></i>
                                </span>
                                <span id="toggle-text">Show Details</span>
                            </button>
                        </div>
                    </div>
                    <div id="intermediate-content" style="display: none;">
                        <div class="columns">
                            <div class="column is-5">
                                <h4 class="title is-6">Generated Code</h4>
                                <pre id="generated-code" style="background-color: #f5f5f5; padding: 1rem; border-radius: 4px; max-height: 320px; overflow-y: auto;">
                                    // Code will appear here
                                </pre>
                            </div>
                            <div class="column is-7">
                                <h4 class="title is-6">Object Detection</h4>
                                <div id="detection-results" style="background-color: #f5f5f5; padding: 1rem; border-radius: 4px; max-height: 320px; overflow-y: auto;">
                                    <div class="columns is-multiline">
                                        <div class="column is-6">
                                            <p class="has-text-centered mb-2">Detection 1</p>
                                            <img id="detection-img-0" src="" alt="Detection 1" style="max-width: 100%; height: auto;">
                                        </div>
                                        <div class="column is-6">
                                            <p class="has-text-centered mb-2">Detection 2</p>
                                            <img id="detection-img-1" src="" alt="Detection 2" style="max-width: 100%; height: auto;">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<section class="section" id="abstract">
    <!-- Abstract. -->
    <div class="container is-max-widescreen">
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
            <h2 class="title is-3">Abstract</h2>
            <div class="content has-text-justified">
                <p>
                    Natural language instructions for robotic manipulation tasks often exhibit ambiguity and vagueness.
                    For instance, the instruction "Hang a mug on the mug tree" may involve multiple valid actions if there are several mugs and branches to choose from.
                    Existing language-conditioned policies typically rely on end-to-end models that jointly handle high-level semantic understanding and low-level action generation,
                    which can result in suboptimal performance due to their lack of modularity and interpretability.
                    To address these challenges, we introduce a novel robotic manipulation framework that can accomplish tasks specified by potentially ambiguous natural language.
                    This framework employs a Vision-Language Model (VLM) to interpret abstract concepts in natural language instructions and generates task-specific code — an interpretable and executable intermediate representation.
                    The generated code interfaces with the perception module to produce 3D attention maps that highlight task-relevant regions by integrating spatial and semantic information, effectively resolving ambiguities in instructions.
                    Through extensive experiments, we identify key limitations of current imitation learning methods, such as poor adaptation to language and environmental variations.
                    We show that our approach excels across challenging manipulation tasks involving language ambiguity, contact-rich manipulation, and multi-object interactions.
                </p>
            </div>
            </div>
        </div>
    </div>
  
    <!-- Paper video. -->
    <br>
    <br>
  
    <div class="container is-max-widescreen" id="video">
        <div class="columns is-centered has-text-centered">
            <div class="column is-full">
            <h2 class="title is-3">Video</h2>
            <div class="publication-video">
              <iframe src="https://www.youtube.com/embed/IaDySSp5Wf8"
                      frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            </div>
            </div>
        </div>
    </div>
  
</section>


<section class="section" id="method-overview">
    <div class="container">
        <div class="columns is-centered has-text-centered">
            <div class="column is-12">
                <h2 class="title is-3">Method Overview</h2>
            </div>
        </div>
        <div class="columns is-centered">
            <figure class="image" style="width: 100%; height: 400px; display: flex; align-items: center; justify-content: center;">
                <img src="media/images/method.png" alt="Method Overview" style="max-width: 90%; max-height: 90%; object-fit: contain;">
            </figure>
        </div>
    </div>
</section>


<section class="section" id="results">
    <div class="container">
        <div class="columns is-centered has-text-centered">
            <div class="column is-12">
                <h2 class="title is-3">Results</h2>
                <h2 class="title is-4">More Natural Language Interaction</h2>
            </div>
        </div>
    </div>
    <br>
    <!-- list of videos -->
    <section class="hero is-light is-small">
        <div class="hero-body">
            <div class="container">
                <div id="results-carousel" class="carousel results-carousel">
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/1.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/2.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/3.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/4.mp4" type="video/mp4">
                        </video>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <br>
    <br>
    <div class="container">
        <div class="columns is-centered has-text-centered">
            <div class="column is-12">
                <h2 class="title is-4">Fine-Grained Semantic Understanding</h2>
            </div>
        </div>
    </div>
    <br>
    <section class="hero is-light is-small">
        <div class="hero-body">
            <div class="container">
                <div id="results-carousel" class="carousel results-carousel">
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/5.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/6.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/7.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/8.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/9.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/10.mp4" type="video/mp4">
                        </video>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <br>
    <br>
    <div class="container">
        <div class="columns is-centered has-text-centered">
            <div class="column is-12">
                <h2 class="title is-4">Geometric Reasoning</h2>
            </div>
        </div>
    </div>
    <br>
    <section class="hero is-light is-small">
        <div class="hero-body">
            <div class="container">
                <div id="results-carousel" class="carousel results-carousel">
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/11.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/12.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/13.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/14.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/15.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="item">
                        <video poster="" autoplay muted loop height="100%">
                            <source src="media/video/16.mp4" type="video/mp4">
                        </video>
                    </div>
                </div>
            </div>
        </div>
    </section>
</section>


<section class="section" id="bibtex">
    <div class="container">
        <div class="columns is-centered has-text-centered">
            <div class="column is-12">
                <h2 class="title is-3">Bibtex</h2>
            </div>
        </div>
        <div class="columns is-centered">
            <div class="column is-12">
                <pre><code>@inproceedings{yin2025codediffuser,
               title={CodeDiffuser: Attention-Enhanced Diffusion Policy via VLM-Generated Code for Instruction Ambiguity},
               author={Yin, Guang and Li, Yitong and Wang, Yixuan and McConachie, Dale and Shah, Paarth and Hashimoto, Kunimatsu and Zhang, Huan and Liu, Katherine and Li, Yunzhu},
               booktitle={Proceedings of Robotics: Science and Systems (RSS)},
               year={2025}}
                </code></pre>
            </div>
        </div>
    </div>
</section>

<script src="app.js"></script>
</body>
</html>

